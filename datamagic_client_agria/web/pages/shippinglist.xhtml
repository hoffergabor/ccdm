<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:p="http://primefaces.prime.com.tr/ui"
	template="/pages/template.xhtml">

	<ui:define name="body">
		<div class="content textcolor1 backgroundcolor3"><h:form
			id="shippingform" target="mywindow">
			<p:panel styleClass="gradpanel" id="panel">
				<div class="innerPanel"><p:dataTable selectionMode="single"
					rows="10" paginator="true" paginatorPosition="top"
					style="text-align:left" paginatorAlwaysVisible="false"
					emptyMessage="#{msg.NODATA}" dynamic="true"
					update="shippingTableItem" onselectComplete="showitem()"
					selection="#{shippingserviceController.data.selectedShipping}"
					value="#{shippingserviceController.data.shippings}" var="data"
					id="shippingTable">
					<p:column sortBy="#{data.sorszam}" style="min-width:120px">
						<f:facet name="header">
							<h:outputText value="#{msg.ORDERS_ORDERVIEW_ORDERNUM}" />
						</f:facet>
						<h:outputText styleClass="bold" value="#{data.sorszam}" />
					</p:column>
					<p:column sortBy="#{data.vnev}" style="min-width:250px">
						<f:facet name="header">
							<h:outputText value="#{msg.SHIPPINGLIST_BUYER}" />
						</f:facet>
						<h:outputText value="#{data.vnev}" />
					</p:column>
					<p:column sortBy="#{data.kelt}" styleClass="centerpos"
						style="min-width:120px">
						<f:facet name="header">
							<h:outputText value="#{msg.SHIPPINGLIST_WARRANT}" />
						</f:facet>
						<h:outputText
							value="#{data.kelt!='1900-01-01 00:00:00.0'? data.kelt:'-'}">
							<f:convertDateTime pattern="#{msg.DATEFORMAT3}"
								timeZone="Europe/Budapest" />
						</h:outputText>
					</p:column>
					<p:column sortBy="#{data.esedkelt}" styleClass="centerpos"
						style="min-width:120px">
						<f:facet name="header">
							<h:outputText value="#{msg.SHIPPINGLIST_DUE}" />
						</f:facet>
						<h:outputText
							value="#{data.esedkelt!='1900-01-01 00:00:00.0'? data.esedkelt:'-'}">
							<f:convertDateTime pattern="#{msg.DATEFORMAT3}"
								timeZone="Europe/Budapest" />
						</h:outputText>
					</p:column>
					<p:column sortBy="#{data.dnetto}" styleClass="rightpos"
						style="min-width:80px">
						<f:facet name="header">
							<h:outputText value="#{msg.NEWORDER_ELEMENTS_NET}" />
						</f:facet>
						<h:outputText value="#{data.dnetto}">
							<f:convertNumber pattern="#,##0" />
						</h:outputText>
						<h:outputText value=" #{data.devnem}"></h:outputText>
					</p:column>
					<p:column sortBy="#{data.dbrutto}" styleClass="rightpos"
						style="min-width:80px">
						<f:facet name="header">
							<h:outputText value="#{msg.NEWORDER_ELEMENTS_GRO}" />
						</f:facet>
						<h:outputText value="#{data.dbrutto}">
							<f:convertNumber pattern="#,##0" />
						</h:outputText>
						<h:outputText value=" #{data.devnem}"></h:outputText>
					</p:column>
				</p:dataTable></div>

				<div class="summaryPanel"><h:panelGroup id="summaryPanel">
					<table width="100%" border="0" cellspacing="0" cellpadding="0">
						<tr>
							<td width="60%"><label>#{msg.ORDERS_ORDERVIEW_SUMMARY}</label></td>
							<td width="20%"><label>#{msg.NEWORDER_ELEMENTS_NET}</label></td>
							<td width="20%" class="last"><label>#{msg.NEWORDER_ELEMENTS_GRO}</label></td>
						</tr>
						<tr>
							<td></td>
							<td><h:outputText
								value="#{shippingserviceController.data.netto}">
								<f:convertNumber pattern="#,##0" />
							</h:outputText></td>
							<td class="last"><h:outputText
								value="#{shippingserviceController.data.brutto}">
								<f:convertNumber pattern="#,##0" />
							</h:outputText></td>
						</tr>
					</table>
				</h:panelGroup></div>

				<div class="bottomFilterBar">
				<div class="bottomFilterBarFilters"><p:commandButton
					process="@this" value="Telephelyek"
					oncomplete="partnerchoosewid2.show()" update="cpp2"
					rendered="#{shippingserviceController.managedPartner!=null and !empty shippingserviceController.managedStores}"
					actionListener="#{shippingserviceController.showStores}"></p:commandButton>
				</div>
				<div class="bottomFilterBarDates"><h:panelGroup>
					<div class="bottomFilterBarDateFilter"><p:calendar
						value="#{shippingserviceController.data.from}"
						selectListener="#{shippingserviceController.shippingDateFromChange}"
						onSelectUpdate="shippingTable,summaryPanel"
						pattern="#{msg.DATEFORMAT}" inputStyle="width:100px">
					</p:calendar></div>
					<div class="bottomFilterBarDateFilter"><label
						class="textcolor4"> #{msg.INVOICESTORNFIX_DATEFROM}</label></div>
					<div class="bottomFilterBarDateFilter"><p:calendar
						value="#{shippingserviceController.data.to}"
						selectListener="#{shippingserviceController.shippingDateToChange}"
						onSelectUpdate="shippingTable,summaryPanel"
						pattern="#{msg.DATEFORMAT}" inputStyle="width:100px">
					</p:calendar></div>
					<div class="bottomFilterBarDateFilter"><label
						class="textcolor4"> #{msg.INVOICESTORNFIX_DATETO}</label></div>

					<p:commandButton process="@this" value="Szűrés"
						update="panel,message" styleClass="filterSubmitButton"
						actionListener="#{shippingserviceController.shippingDateChange}"></p:commandButton>
					<p:commandButton update="panel" styleClass="filterResetButton"
						actionListener="#{shippingserviceController.resetAction}"
						value="reset" process="@this"></p:commandButton>
				</h:panelGroup></div>
				</div>
				<h:commandLink
					disabled="#{empty shippingserviceController.data.shippings}"
					value="#{msg.ORDERS_PRINT_BUTTON1}" styleClass="commonButtonLink"
					immediate="true" action="#{shippingserviceController.print}" />
				<p:commandButton value="#{msg.CHART}" oncomplete="chartwid.show()"
					rendered="#{loginserviceController.managedUser.userType!='DM_PARTNER'}"
					update="chart,summaryAll,chartcalendar" id="chartbutton"
					action="#{shippingserviceController.createDataForChart}"
					process="@this" styleClass="commonButton" />
				<div class="clear"></div>
			</p:panel>

			<p:remoteCommand name="showitem" oncomplete="shippingitemwid.show()"
				update="shippingTableItem" process="@this"
				actionListener="#{shippingserviceController.getShippingItem}"></p:remoteCommand>


			<p:dialog id="shippingItems" modal="false"
				widgetVar="shippingitemwid" closable="true"
				styleClass="commonDialog" draggable="true" width="960"
				showEffect="fade" hideEffect="fade" header="Szállítólevél tétel">
				<p:dataTable style="text-align:left;" emptyMessage="#{msg.NODATA}"
					selectionMode="single" dynamic="true"
					value="#{shippingserviceController.data.shippingItems}" var="item"
					id="shippingTableItem">
					<p:column sortBy="#{item.arukod}" style="min-width:100px">
						<f:facet name="header">
							<h:outputText value="ARUKOD" />
						</f:facet>
						<h:outputText value="#{item.arukod}" styleClass="bold" />
					</p:column>
					<p:column sortBy="#{item.acikksz}" style="min-width:100px">
						<f:facet name="header">
							<h:outputText value="CIKKSZAM" />
						</f:facet>
						<h:outputText value="#{item.acikksz}" />
					</p:column>
					<p:column sortBy="#{item.amegn}" style="min-width:250px">
						<f:facet name="header">
							<h:outputText value="MEGNEVEZES" />
						</f:facet>
						<h:outputText value="#{item.amegn}" />
					</p:column>
					<p:column sortBy="#{item.ear}" styleClass="rightpos"
						style="min-width:80px">
						<f:facet name="header">
							<h:outputText value="EGYSEGAR" />
						</f:facet>
						<h:outputText value="#{item.ear}">
							<f:convertNumber pattern="#,##0" />
						</h:outputText>
					</p:column>
					<p:column sortBy="#{item.amenny}" styleClass="rightpos"
						style="min-width:80px">
						<f:facet name="header">
							<h:outputText value="MENNYISEG" />
						</f:facet>
						<h:outputText value="#{item.amenny}">
							<f:convertNumber pattern="#,##0" />
						</h:outputText>
					</p:column>
					<p:column sortBy="#{item.hnertek}" styleClass="rightpos"
						style="min-width:80px">
						<f:facet name="header">
							<h:outputText value="NETTO" />
						</f:facet>
						<h:outputText value="#{item.hnertek}">
							<f:convertNumber pattern="#,##0" />
						</h:outputText>
					</p:column>
					<p:column sortBy="#{item.hbertek}" styleClass="rightpos"
						style="min-width:80px">
						<f:facet name="header">
							<h:outputText value="BRUTTO" />
						</f:facet>
						<h:outputText value="#{item.hbertek}">
							<f:convertNumber pattern="#,##0" />
						</h:outputText>
					</p:column>
				</p:dataTable>
			</p:dialog>


			<p:dialog id="chartdialog" modal="true" widgetVar="chartwid"
				showEffect="fade" hideEffect="fade" closable="true"
				styleClass="commonDialog" draggable="true" header="Grafikon"
				width="720">
				<br />
				<p:lineChart value="#{shippingserviceController.data.chartList}"
					id="chart" var="data" xfield="#{data[1]}" width="700px">
					<p:chartSeries label="Bejovo" value="#{data[2]}" />
				</p:lineChart>
				<div class="chartSummaryPanel">
				<div class="summaryPanel"><h:panelGroup id="summaryAll">
					<table width="100%" border="0" cellspacing="0" cellpadding="0">
						<tr>
							<td width="20%"><label>#{msg.ORDERIN_TITLE}</label></td>
							<td width="20%"><label>#{msg.ALL}:</label></td>
							<td width="20%"><label>#{msg.SIDEBAR_DEBITTEXT_TITLE}</label></td>
							<td width="20%"><label>#{msg.PAYED}:</label></td>
							<td width="20%" class="last"><label>#{msg.EXPIRED}:</label></td>
						</tr>
						<tr>
							<td></td>
							<td width="20%"><h:outputText
								value="#{shippingserviceController.data.sum}"
								style="color:#e6c44c">
								<f:convertNumber pattern="#,##0" />
							</h:outputText></td>
							<td width="20%"><h:outputText
								value="#{shippingserviceController.data.debit}"
								style="color:#e6c44c">
								<f:convertNumber pattern="#,##0" />
							</h:outputText></td>
							<td width="20%"><h:outputText
								value="#{shippingserviceController.data.payed}"
								style="color:#e6c44c">
								<f:convertNumber pattern="#,##0" />
							</h:outputText></td>
							<td width="20%" class="last"><h:outputText
								value="#{shippingserviceController.data.expired}"
								style="color:#e6c44c">
								<f:convertNumber pattern="#,##0" />
							</h:outputText></td>
						</tr>
					</table>
				</h:panelGroup></div>
				</div>
				<br />
				<h:panelGroup id="chartcalendar">
					<div style="margin-right: 20px; float: left;"><p:calendar
						id="chartFrom" value="#{shippingserviceController.data.chartFrom}"
						selectListener="#{shippingserviceController.shippingChartDateFromChange}"
						onSelectUpdate="chart,chartcalendar" pattern="#{msg.DATEFORMAT}"
						inputStyle="width:100px">
					</p:calendar><label class="textcolor4"> #{msg.INVOICESTORNFIX_DATEFROM}</label></div>
					<div style="margin-right: 20px; float: left;"><p:calendar
						id="chartTo" value="#{shippingserviceController.data.chartTo}"
						selectListener="#{shippingserviceController.shippingChartDateToChange}"
						onSelectUpdate="chart,chartcalendar" pattern="#{msg.DATEFORMAT}"
						inputStyle="width:100px">
					</p:calendar><label class="textcolor4"> #{msg.INVOICESTORNFIX_DATETO}</label></div>
				</h:panelGroup>
			</p:dialog>

			<p:dialog widgetVar="partnerchoosewid2" modal="false" closable="true"
				styleClass="commonDialog" draggable="true"
				header="Válassza ki a partnert" resizable="false">
				<h:panelGroup id="cpp2">
					<div class="choosepartner-sales-form">
					<div class="popupSearch"><h:inputText styleClass="input"
						value="#{shippingserviceController.data.partnerSearchText}"></h:inputText>
					<p:commandButton value="Keresés" update="cpp"
						styleClass="popupSearchButton"
						action="#{shippingserviceController.searchPartnerAction}" /></div>
					<div class="partnerSearchList"
						style="width: 265px; height: 410px; overflow-x: hidden; overflow-y: scroll; border: 1px solid #ccc; padding: 5px; margin-bottom: 20px; background: #eee;">
					<ui:repeat value="#{shippingserviceController.data.allPartner}"
						var="data">
						<p:commandLink value="#{data[0]}" update="panel" process="@this"
							oncomplete="showstore()">
							<f:setPropertyActionListener value="#{data[1]}"
								target="#{shippingserviceController.data.selectedPartnerId}" />
						</p:commandLink>
						<br />
					</ui:repeat></div>
					</div>
				</h:panelGroup>
			</p:dialog>
			
			<p:remoteCommand name="showstore"
					action="#{shippingserviceController.submitChooseStore}"
					oncomplete="partnerchoosewid2.hide()" update="panel" process="@this"></p:remoteCommand>

			<p:growl id="message" showDetail="true" sticky="false" life="4000"
				showSummary="true" />

		</h:form></div>

		<div class="helpContent" onclick="RemoveHelp();" id="help">
		<div class="headerHelp"></div>
		<div class="menuHelp">
		<div class="helpBubble"
			style="top: 100px; left: 530px; border-top-left-radius: 0; -moz-border-radius-topleft: 0; -webkit-border-top-left-radius: 0;">
		A <strong>SZÁLLÍTÓLEVÉL</strong> menüpontban van, itt láthatja
		telephelye(i) szállítóleveleit, illetve megnézheti azok részleteit,
		egyes időszakokra összegzést.</div>
		</div>
		<div class="contentHelp">
		<div class="helpBubble"
			style="top: 300px; left: 530px; border-top-right-radius: 0; -moz-border-radius-topright: 0; -webkit-border-top-right-radius: 0;">
		Ebben a listában láthatja a dátum szűrés eredményét, <strong>egy
		adott időszakon belüli szállítóleveleinek listáját.</strong></div>
		</div>
		<div class="contentHelp">
		<div class="helpBubble"
			style="top: 550px; left: 160px; border-bottom-left-radius: 0; -moz-border-radius-bottomleft: 0; -webkit-border-bottom-left-radius: 0;">
		A dátumok beállításával meghatározhatja melyik időszak
		szállítóleveleit szeretné megtekinteni</div>
		</div>
		<div class="footerHelp">
		<div class="helpBubble"
			style="top: 550px; right: 80px; border-bottom-right-radius: 0; -moz-border-radius-bottomright: 0; -webkit-border-bottom-right-radius: 0;">
		Ki<strong>NYOMTAT</strong>hatja az éppen látható listát, illetve
		megtekintheti az elmúlt egy év havi összegzéseit <strong>GRAFIKON</strong>on.
		</div>
		</div>
		</div>
		<script type="text/javascript">
	function newWindow() {
		window.open('', 'mywindow', 'width=1000,height=700');
		return false;
	}
</script>
	</ui:define>
</ui:composition>